# 提交规范
**项目名称：** 海外自动化营销系统  
**版本号：** V1.0  
**发布日期：** 2025-08-08  
**撰写人：** 开发规范组  

---

## 1. 目的
本规范旨在统一 Git 提交信息的格式与内容，提升代码历史记录的可读性、可追溯性，并支持自动化生成版本日志（CHANGELOG）与版本号管理（语义化版本）。

---

## 2. 适用范围
- 本系统所有代码仓库
- 所有分支（feature、fix、hotfix、release 等）
- 全体开发人员

---

## 3. 提交信息格式（Conventional Commits）

### 3.1 基本格式
```
<type>(<scope>): <subject>

<body>

<footer>
```

- `<type>`：提交类型（必填）
- `<scope>`：影响范围（可选），通常是模块名或文件夹名
- `<subject>`：简要描述，建议 ≤ 50 字符
- `<body>`：详细说明改动内容、动机、影响（可选）
- `<footer>`：关联任务/问题，如 `JIRA-123`、`Closes #45`（可选）

---

### 3.2 提交类型（type）

| 类型     | 说明                               | 示例                                   |
| -------- | ---------------------------------- | -------------------------------------- |
| feat     | 新功能                             | `feat(customer): 新增客户批量导入功能` |
| fix      | 修复缺陷                           | `fix(template): 修复模板变量渲染错误`  |
| docs     | 文档变更                           | `docs(readme): 更新部署说明`           |
| style    | 代码格式调整（不影响逻辑）         | `style(ui): 调整按钮间距`              |
| refactor | 重构（既不修复 bug，也不加新功能） | `refactor(api): 优化分页查询逻辑`      |
| perf     | 性能优化                           | `perf(message): 提升批量发送效率`      |
| test     | 测试相关改动                       | `test(customer): 增加导入功能单元测试` |
| chore    | 构建/依赖/工具等杂务               | `chore(deps): 升级 redis 至 7.x`       |
| revert   | 回滚某次提交                       | `revert: 回滚 feat(customer) 导入功能` |

---

### 3.3 影响范围（scope）
- 模块名：`customer`、`template`、`message`、`tracking`、`user`
- 公共：`common`、`utils`、`config`
- 其他：`build`、`deps`、`ci`

---

### 3.4 提交示例

#### 1）新功能
```
feat(customer): 新增客户批量导入功能

- 支持 Excel/CSV 格式文件
- 增加导入结果日志
- 验证重复客户并提示
```

#### 2）修复 bug
```
fix(template): 修复模板变量渲染错误

原因：
- 模板引擎变量名与数据库字段不一致

解决：
- 调整变量映射逻辑
- 增加单元测试覆盖边界情况
```

#### 3）文档更新
```
docs(deployment): 新增 Kubernetes 部署步骤
```

#### 4）回滚
```
revert: 回滚 feat(customer) 导入功能

原因：影响数据一致性，将在修复后重新提交
```

---

## 4. 编写要求
1. 所有提交信息必须符合规范，否则禁止合并到主分支。
2. 中文提交需保持简洁，不超过 50 个字，必要时在 body 部分详细说明。
3. 一个提交只做一件事，不要混合多个无关改动。
4. 与需求/缺陷管理系统关联：
   - Jira 示例：`JIRA-123`
   - GitHub 示例：`Closes #45`

---

## 5. 工具与自动化
- **Commitlint**：校验提交信息格式  
  配置示例（`commitlint.config.js`）：
  ```js
  module.exports = { extends: ['@commitlint/config-conventional'] }
  ```
- **Husky**：在 `git commit` 阶段执行 commitlint 检查  
  安装示例：
  ```bash
  npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'
  ```
- **Semantic Release**：结合提交信息自动生成 CHANGELOG 与发布版本

---

## 6. 版本与变更记录
- **V1.0**：建立基于 Conventional Commits 的提交规范

---